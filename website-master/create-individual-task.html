<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta http-equiv="Content-Language" content="ar" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <link rel="stylesheet" type="text/css" href="hanadi.css" />
  <link rel="shortcut icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAS5SURBVGhD7VhbT1xVFEYfjA8an0xM1MQ/4Ksm+sBD58acw8DA3jNcLMzItOWSthJMiwIFWrAYi1qTqrUxwXgjFkNbW6SWak1Te1GkUIECLdOBKaXlDgWsNS7XnrPPmTNwhtBxmCHmfMkXCPuctb5vr7332pwEHTp06NChQ4eO/zESKX3MIBCbUSTlRpF+YBRII/7+iUkku02iI9ViIU/yR9cnjMmOl1HwcRT/p0mksALvo6kTRjHdxF9dHzClOJ9lwtRizckO8BQUw443q6Gsci+U7NwF7s1bA39XP2cSyGlzivM5Hip+YLOKVbgjC9tcVAItrafh9u0JWFy8r3Byag6Ghkeg9+oAfPFVE7y6ZbtiBt+fYUuRh4w9AvtAIH8zMXaHC062/QwLC3+FGFBzfv4ejI6Ogc/nhxs3huHLxiawkY2yIbbcnDx07GC0pr9oFOg8E5GX/xp4vTc1xWtxfHw6YIbx4qUOyHbnS5URyD2TNf0lnmLtkZiY+yguh2ss+SvuAvD7RzUFr8QpXGqymY6OLnBu3MQrQ/w2m+1xnmptgTNXw5ImpWRAT+91TaGrodrMqbYzykFgtJKDZoFWYZ4jJoGeMVnJYZZTEHKe5hL+O9hs4azdZQkPHGzQFPggHBubUsyUVtTwqoQnGhqxCE7K5UQOg0g8LKA1NXPZyRQpR0buwMeHPgOLzRki2mxzgGDPBMvSI5uNifQCpfQRLuvBgTPyAwtUVbNPU1QkrN//kSLQ7siFPW/VQ3dPf2BsYmImUK1z53+Dsl21S0yRWxGbkXtG87HWZYIiZba7MCCsvGovCp9dNj41fVdZft29/ZCZu0UxY0yml7m01UPq4FKAy509yxJGyqt9Xmj78eyKPUi9l7zeIchyFShmNoikkEsMj8rKyoexhG6sxEV8CZuW9HKqIwdq394Pff1ezcTRJjM57L+lmOnruw5JtgxuhsxwudqwWulTeBc6L4vXojU1AxoPH9VMHm2qGyljTd27QR3hGqnBQJ/Ajd0tP/h6aRV8f/InuPJHH/za3gUNn38DjmyPEuiXC+2ayaPJubnFECOdXT3s9JI0WOnXXHoosBEdYg+wJtXU3KIZmM0Qu9nSLA/0D/g0n4k21UYYBXtWwAhO+iUuPQiLxf4MDgQug9FoetEku0GrjaRluKSKCOQalx8EbuxCNiimZQVOC62A8aLaBGO2SzqKceIbufwg0MiHbHBbSZlmsHhx6R4ZGBgEUV5aIi3m8oPA46yBDZaW79EMGC/KXV7mt83HpWWF3JBEnufyg8CK1LHBnLwizYDxIvt3QTbBmqJr01ZuhPRw6aHAa7NFdtr++xXNoLHm5ORsSDX2vXdAqQbuD8Klh4JdxHDQyx7Ky98O4xPTmsFjxdnZBRgauqlUov794CUTT6tjKPkhSbkG0IgdH/xHNhOvykxPz4MPTQwO+uDod63gyS9WVYJ2ssbNJYcHmnlDNsOY4ykKNMDq2vo1Z1XNO1BRXQc7y3ZDwbYd6o8UEgXasioTMtAMxfL5QoLEkwIZNCTTTHaZ5RJXD/axwWxNT5M+f9IjeKqdihXxRDqBPz/FvBVo4gWUE34/6NChQ4cOHTp0rFckJPwL4qQcu4ZL4ykAAAAASUVORK5CYII=" />
  <title>أنظمة غيمة - Cloud Systems - إضافة مهمّة فرديّة</title>
  <script src="https://cdn.jsdelivr.net/npm/js-cookie@2/src/js.cookie.min.js"></script>
  <script type="text/javascript" src="js/common.js"></script>

  <script
    src="https://code.jquery.com/jquery-1.8.3.min.js"
    integrity="sha256-YcbK69I5IXQftf/mYD8WY0/KmEDCv1asggHpJk1trM8="
    crossorigin="anonymous"></script>
  <link type="text/css" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jsgrid/1.5.3/jsgrid.min.css" />
  <link type="text/css" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jsgrid/1.5.3/jsgrid-theme.min.css" />
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jsgrid/1.5.3/jsgrid.min.js"></script>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-56731261-3"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-56731261-3');
  </script>
</head>
<body>
  <nav id="error-message" class="error">
    Something went wrong!
  </nav>
  <nav>
    <ul>
      <li>
        <a href="index.html">الرئيسيّة</a>
      </li>
      <li id="user-email"></li>
    </ul>
  </nav>
  <div class="container">
    <div class="logo">
      <a href="index.html">
        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAS5SURBVGhD7VhbT1xVFEYfjA8an0xM1MQ/4Ksm+sBD58acw8DA3jNcLMzItOWSthJMiwIFWrAYi1qTqrUxwXgjFkNbW6SWak1Te1GkUIECLdOBKaXlDgWsNS7XnrPPmTNwhtBxmCHmfMkXCPuctb5vr7332pwEHTp06NChQ4eO/zESKX3MIBCbUSTlRpF+YBRII/7+iUkku02iI9ViIU/yR9cnjMmOl1HwcRT/p0mksALvo6kTRjHdxF9dHzClOJ9lwtRizckO8BQUw443q6Gsci+U7NwF7s1bA39XP2cSyGlzivM5Hip+YLOKVbgjC9tcVAItrafh9u0JWFy8r3Byag6Ghkeg9+oAfPFVE7y6ZbtiBt+fYUuRh4w9AvtAIH8zMXaHC062/QwLC3+FGFBzfv4ejI6Ogc/nhxs3huHLxiawkY2yIbbcnDx07GC0pr9oFOg8E5GX/xp4vTc1xWtxfHw6YIbx4qUOyHbnS5URyD2TNf0lnmLtkZiY+yguh2ss+SvuAvD7RzUFr8QpXGqymY6OLnBu3MQrQ/w2m+1xnmptgTNXw5ImpWRAT+91TaGrodrMqbYzykFgtJKDZoFWYZ4jJoGeMVnJYZZTEHKe5hL+O9hs4azdZQkPHGzQFPggHBubUsyUVtTwqoQnGhqxCE7K5UQOg0g8LKA1NXPZyRQpR0buwMeHPgOLzRki2mxzgGDPBMvSI5uNifQCpfQRLuvBgTPyAwtUVbNPU1QkrN//kSLQ7siFPW/VQ3dPf2BsYmImUK1z53+Dsl21S0yRWxGbkXtG87HWZYIiZba7MCCsvGovCp9dNj41fVdZft29/ZCZu0UxY0yml7m01UPq4FKAy509yxJGyqt9Xmj78eyKPUi9l7zeIchyFShmNoikkEsMj8rKyoexhG6sxEV8CZuW9HKqIwdq394Pff1ezcTRJjM57L+lmOnruw5JtgxuhsxwudqwWulTeBc6L4vXojU1AxoPH9VMHm2qGyljTd27QR3hGqnBQJ/Ajd0tP/h6aRV8f/InuPJHH/za3gUNn38DjmyPEuiXC+2ayaPJubnFECOdXT3s9JI0WOnXXHoosBEdYg+wJtXU3KIZmM0Qu9nSLA/0D/g0n4k21UYYBXtWwAhO+iUuPQiLxf4MDgQug9FoetEku0GrjaRluKSKCOQalx8EbuxCNiimZQVOC62A8aLaBGO2SzqKceIbufwg0MiHbHBbSZlmsHhx6R4ZGBgEUV5aIi3m8oPA46yBDZaW79EMGC/KXV7mt83HpWWF3JBEnufyg8CK1LHBnLwizYDxIvt3QTbBmqJr01ZuhPRw6aHAa7NFdtr++xXNoLHm5ORsSDX2vXdAqQbuD8Klh4JdxHDQyx7Ky98O4xPTmsFjxdnZBRgauqlUov794CUTT6tjKPkhSbkG0IgdH/xHNhOvykxPz4MPTQwO+uDod63gyS9WVYJ2ssbNJYcHmnlDNsOY4ykKNMDq2vo1Z1XNO1BRXQc7y3ZDwbYd6o8UEgXasioTMtAMxfL5QoLEkwIZNCTTTHaZ5RJXD/axwWxNT5M+f9IjeKqdihXxRDqBPz/FvBVo4gWUE34/6NChQ4cOHTp0rFckJPwL4qQcu4ZL4ykAAAAASUVORK5CYII=">
      </a>
    </div>
    <div class="breif">
      <strong>إضافة مهمّة فرديّة:</strong> يُمكن إضافة مهمّة فرديّة وإرسالها إلى جميع المتدرّبين. كلّ متدرّب ستصل إليه رسالةً فيها تفاصيل المهمّة ورابط يتيح للمتدرّب تسليمها. في حال أرسل المتدرّب إجابته يقرّر المُرشد أن يقبلها أو يرفضها، إذا قَبِلها يمتلك المتدرّب المهارة ذات العلاقة، وإن رفضها فلا يمتلك المتدرّب المهارة. في حال تأخّر المتدرّب عن تسليم المهمّة وتجاوز عدد الساعات الأقصى لتسليمها فإنّه لا يحصل على المهارة كذلك.
    </div>
    <div class="form-container">
      <form id="form">
        <div id="preview-mode" class="preview-container">
          <div class="subject">
            مهمّة جديدة: <span id="title-preview">title</span>!
          </div>
          <div class="content">
            <br />خالد السليمان، السلام عليكم.<br /><br />
            <span id="feedback-preview">feedback</span>
            مهمّة جديدة بانتظار إبداعاتِك ويجب تسليمها قبل مرور <span id="expires-after-preview">expiresAfter</span> ساعة من الآن.
            <span id="description-preview">description</span>
            <span id="references-preview">references</span>
            في حال رغبت بتسليم المهمّة، تفضّل بزيارة الرابط:<br />
            <a href="#">https://cloudsystems.sa/individual-tasks/e0cac4ee-98f3-4c23-acd8-f12985a15573/deliver</a><br /><br />
            وفي حال احتجت لمساعدةٍ فلا تتواني بالبحث عنها في قناة المسار <span id="channel-preview">channel</span> في تطبيق Slack.<br /><br />
            كلّ الحظّ النبيل.<br />
            مؤسّسة أنظمة غيمة (Cloud Systems).<br /><br />
          </div>
        </div>
        <div id="edit-mode">
        <div class="form-input">
          <label for="title">عنوان المهمّة (مطلوب)</label>
          <p>هذا العنوان سيكون في عنوان الرسالة، تأكّد من أن يكون فريدًا عن غيره من العناوين الأخرى، ومن عدم إضافة تعجّب في آخره أو أي رمز آخر غير الأقواس.</p>
          <input type="text" id="title" placeholder="التعرّف على Git" required />
        </div>
        <div class="form-input">
          <label for="feedback">التعليق على المهمّة السابقة (إن وُجد)</label>
          <p>هذا التعليق سيقرأه جميع المتدرّبين. إن شئت، فتأكّد من كونِه يثني على من أتقن، ويعتب على من لم يجتهد، ويحفّز، وهكذا. تأكّد من ختمهِ بنقطة.</p>
          <textarea id="feedback" placeholder="ما شاء الله عليكم، لطيف عملكم أمس، توزيعكم للمهام، تصميمكم لواجهات المستخدم، ثم تطبيقها على الموقع."></textarea>
        </div>
        <div class="form-input">
          <label for="description">وصف المهمّة (مطلوب)</label>
          <p>تأكّد من وضوح وصف المهمّة ومن كتابته بصيغة الأمر "إقرأ"، "صمّم"، وهكذا، وتأكّد من ختمهِ بنقطة.</p>
          <textarea id="description" placeholder="أنشيء صفحة ويب تُبرز فيها سيرتك الذاتيّة." required></textarea>
        </div>
        <div class="form-input">
          <label for="mentors">البريد الإلكتروني للمُرشدين (مطلوب)</label>
          <p>المُرشد هو من يقوم بعملية التصحيح والمتابعة. يُمكن إضافة مُرشد أو أكثر من خلال وضع فاصلة باللغة الإنجليزيّة "," بين كلّ مُرشدٍ وآخر.</p>
          <input type="text" id="mentors" placeholder="example@example.com" required />
        </div>
        <div class="form-input">
          <label for="skill">المهارة ذات العلاقة (مطلوب)</label>
          <p>تأكّد من نسخ اسم المهارة من <a href="https://docs.google.com/spreadsheets/d/1-8ji_oF0tjxQnIdKJdszpJz8UYiK6BEhFMisz0fkeiM/edit?usp=sharing" target="_blank">جدول المهارات الخاصّة بهذا البرنامج التدريبيّ</a>؛ لأنّ المتدرّب سيمتلك هذه المهارة بمجرّد إتمامه لهذه المهمّة بشكلٍ صحيح. يجب إدخال مهارة واحدة فقط.</p>
          <input type="text" id="skill" placeholder="Quality Assurance Fundamentals" required />
        </div>
        <div class="form-input">
          <label for="references">المراجع (إن وُجد)</label>
          <!-- <p>في حال وجود مراجع؛ تأكّد من أن يبدأ كلّ مرجع في سطر جديد بعد علامة الناقص "-"، ثم مسافة ثم عبارات تصف بها المرجع، ثم مسافة ثم بين قوسين ضع رابط المرجع، ثم نقطة لإنهاء المرجع، وهكذا مع بقيّة المراجع.</p>
          <textarea id="references" placeholder="- المرجع 1 (URL1)."></textarea> -->
        </div>
        <div id="jsGrid"></div>
        <div class="form-input">
          <label for="channel">قناة Slack (مطلوب)</label>
          <input type="text" id="channel" placeholder="developer" required />
        </div>
        <div class="form-input">
          <label for="expiresAfter">عدد الساعات الأقصى لتسليم المهمّة (مطلوب)</label>
          <input type="text" id="expiresAfter" placeholder="24" required />
        </div>
        </div>
        <div class="form-buttons">
          <button id="preview" class="submit">عاين الرسالة</button>
          <input type="submit" id="submit" class="submit" value="أرسِل المهمّة" />
          <button id="edit" class="secondary">عدِّل المهمّة</button>
        </div>
      </form>
    </div>
    <div class="copyrights">
      (ح) جميع الحقوق محفوظة لمؤسّسة أنظمة غيمة (Cloud Systems).
    </div>
  </div>
  <script type="text/javascript">

    redirectToProfileIfNotLoggedIn();
    updateLoginBox();

    function updateLoginBox() {
      var userEmail = document.getElementById('user-email');
      var cookiesEmail = Cookies.get('email');
      if (cookiesEmail) {
        userEmail.innerHTML = '<a href="profile.html">' + cookiesEmail + '</a>';
      }
    }

  var userReferences = [];
  var references = '';
 
  $(function() {
    $('#jsGrid').jsGrid({
      width: '100%',
      height: '300px',
      inserting: true,
      editing: true,
      sorting: true,
      paging: true,
      
      data: userReferences,
      confirmDeleting: false,
      noDataContent: 'لم يتم إضافة مراجع حتّى الآن.',

      fields: [
        { name: 'عنوان المرجع', type: 'text', validate: 'required' },
        { name: 'رابط المرجع (URL)', type: 'text', validate: 'required' },
        { type: 'control' },
      ]
    });
  });

    // Define some variables.
    var accessToken = Cookies.get('accessToken');
    var errorMessage = document.getElementById('error-message');
    var form = document.getElementById('form');
    var title = document.getElementById('title');
    var feedback = document.getElementById('feedback');
    var description = document.getElementById('description');
    var mentors = document.getElementById('mentors');
    var skill = document.getElementById('skill');
    var channel = document.getElementById('channel');
    var expiresAfter = document.getElementById('expiresAfter');
    var preview = document.getElementById('preview');
    var edit = document.getElementById('edit');
    var submit = document.getElementById('submit');

    // Modes.
    var editMode = document.getElementById('edit-mode');
    var previewMode = document.getElementById('preview-mode');

    // Preview.
    var titlePreview = document.getElementById('title-preview');
    var feedbackPreview = document.getElementById('feedback-preview');
    var descriptionPreview = document.getElementById('description-preview');
    var referencesPreview = document.getElementById('references-preview');
    var expiresAfterPreview = document.getElementById('expires-after-preview');
    var channelPreview = document.getElementById('channel-preview');

    // Hide the error message initially.
    errorMessage.style.display = 'none';
    previewMode.style.display = 'none';
    submit.style.display = 'none';
    edit.style.display = 'none';

    function parseReferences(references) {
      var list = [];
      for (var i=0; i<references.length; i++) {
        list.push({
          title: references[i]['عنوان المرجع'],
          url: references[i]['رابط المرجع (URL)'],
        });
      }
      return list;
    }

    // Define variables to be used to send a request.
    var http = new XMLHttpRequest();
    var url = 'https://d2hbxkrooc.execute-api.eu-west-1.amazonaws.com/dev/individual-tasks';

    http.onreadystatechange = function() {
      if (http.readyState == XMLHttpRequest.DONE) {
        submit.disabled = false;
        if (http.status == 204) {
          return window.location.href = 'thank-you-for-creating-task.html';
        }
        errorMessage.style.display = 'block';
        edit.style.display = 'inline-block';
        if (http.status == 400) {
          errorMessage.innerHTML = 'الرجاء التأكّد من تعبئة الحقول المطلوبة بالشكل الصحيح.';
        }
        if (http.status == 404) {
          errorMessage.innerHTML = 'الرجاء التأكّد من صحّة البريد الإلكتروني للمُرشدين ومن تسجيلهم في البرنامج.';
        }
        if (http.status == 401) {
          errorMessage.innerHTML = 'لا يُمكن الوصول إلى هذه الصفحة.';
        }
        if (http.status == 408) {
          errorMessage.innerHTML = 'لا يُمكن إضفاة المهمّة الآن، نرجو المحاولة لاحقًا.';
        }
      }
    }

    var handlePreview = function(event) {
      if (form.checkValidity() == false) return;
      event.preventDefault();
      editMode.style.display = 'none';
      previewMode.style.display = 'block';
      preview.style.display = 'none';
      submit.style.display = 'inline-block';
      edit.style.display = 'inline-block';
      titlePreview.innerHTML = title.value;
      feedbackPreview.innerHTML = (feedback.value == '') ? '' : feedback.value.replace(/(?:\r\n|\r|\n)/g, '<br />') + '<br /><br />';
      descriptionPreview.innerHTML = description.value.replace(/(?:\r\n|\r|\n)/g, '<br />') + '<br /><br />';
      expiresAfterPreview.innerHTML = expiresAfter.value;
      channelPreview.innerHTML = channel.value;

      var parsedReferences = parseReferences(userReferences);
      var referencesPreviewHTML = '';

      if (parsedReferences.length == 0) {
        referencesPreview.innerHTML = '';
      } else {
        referencesPreviewHTML = 'المراجع:<br />';
        for (var i = 0; i < parsedReferences.length; i++) {
          referencesPreviewHTML += '<br />- ' + parsedReferences[i].title + ' (<a href="#">' + parsedReferences[i].url + '</a>).';
          references += '- ' + parsedReferences[i].title + ' (' + parsedReferences[i].url + ').\n';
        }
        referencesPreviewHTML += '<br /><br />';
      }

      referencesPreview.innerHTML = referencesPreviewHTML;
    }

    var handleEdit = function(event) {
      event.preventDefault();
      editMode.style.display = 'block';
      previewMode.style.display = 'none';
      preview.style.display = 'inline-block';
      submit.style.display = 'none';
      edit.style.display = 'none';
    }

    var handleSubmit = function(event) {
      event.preventDefault();
      edit.style.display = 'none';
      submit.disabled = true;
      errorMessage.style.display = 'none';

      http.open('POST', url, true);

      // Set some headers.
      http.setRequestHeader('Content-type', 'application/json');
      http.setRequestHeader('Accept', 'application/json');
      http.setRequestHeader('Authorization', 'Bearer ' + accessToken);

      // Make a new request.
      var params = JSON.stringify({
        'title': title.value,
        'feedback': feedback.value,
        'description': description.value,
        'mentors': mentors.value,
        'skill': skill.value,
        'channel': channel.value,
        'expiresAfter': expiresAfter.value,
        'references': references,
      });

      http.send(params);
    }

    // Start dealing with them.
    form.addEventListener('submit', handleSubmit, false);
    preview.addEventListener('click', handlePreview, false);
    edit.addEventListener('click', handleEdit, false);

  </script>
</body>
</html>